<!DOCTYPE html>
<html lang="en">
  <head>


    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

   
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous">

    <title>View Data</title>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
          <a class="navbar-brand" href="#">Centum</a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                <li class="nav-item">
                    <a class="nav-link" href="dashboard.html">Dashboard</a>
                  </li>
              <li class="nav-item">
                <a class="nav-link" href="login.html">Sign Out</a>
              </li>
              
            </ul>
           
          </div>
        </div>
      </nav>
    <div class='row' style='margin:30px'>
        <div class='col-md-12'>
             <h4>Data Preview</h4>
        </div>
    <div class='col-md-12'>
     
             
                  <div style='border:2px dotted black;padding:20px;width:750px' id='demo'>


                    <table style='width:700px' id="demoo">
                        <tbody>
                            <tr>
                                
                                <td colspan=3>
                                    <div  style='float:right'>
                                        <img src="logo.png" style='width:70px' alt="">
                                    </div>
                                   
                                </td>
                            </tr>
                            <tr>
                                <td colspan=3>
                                    <p style='font-weight:bold'>Date: {{Form.date}} </p>
                                    <p style='font-weight:bold'>Time: {{Form.time}}</p>
                                </td>
                            </tr>
                            <tr>
                                <td colspan=3>
                                    <p>Dear Security,</p>
                                </td>
                            </tr>
                            <tr>
                                <td colspan=3>

                                    <p style="font-weight:bold">REF: <span style='text-decoration: underline;'>ASSET MOVEMENT FORM NUMBER: TDL_00{{Form.id}}</span></p>
                                </td>
                            </tr>
                            <tr>
                                <td colspan=3>

                                    <p>Kindly allow {{Form.person_name}} of ID Number {{Form.person_id}} to transfer the asset with details listed below:</p>
                                </td>
                            </tr>
                            <tr>
                                <td colspan=3>
                                    <p style="font-weight:bold;font-size:0.8em">Asset Type: {{Form.asset_name}}</p>
                                    <p style="font-weight:bold;font-size:0.8em">Asset Serial Number: {{Form.asset_sn}}</p>
                                    <p style="font-weight:bold;font-size:0.8em">From: {{Form.place_from}}</p>
                                    <p style="font-weight:bold;font-size:0.8em">To: {{Form.place_to}}</p>
                                </td>
                            </tr>
                            <tr>
                                <td >
                                    <p style='margin-bottom:50px'>Collected By</p>
                                    <p style="font-weight:bold;font-size:0.8em">Name:{{Form.receiver}} </p>
                                    <p style="font-weight:bold;font-size:0.8em">For:{{Form.place_to}} </p>
                                </td>
                                <td></td>
                                <td colspan="4">
                                    <p style='margin-bottom:50px'>Confirmed By</p>
                                    


                                    <p style="font-weight:bold;font-size:0.8em">Name:{{Form.confirmer}} </p>
                                    <p style="font-weight:bold;font-size:0.8em">For:{{Form.place_from}} </p>
                                    
                                </td>
                            </tr>
                            <tr style='margin-top:200px'>
                                                            <td>
                                   <p style='color:#ffe390'>www.tierdata.co.ke</p>
                                </td>
                                <td></td>

                                
                                <td>
                                    <p style='font-weight:bold;color:#82aace'>Tier Data Limited</p>
                                    <p style='font-weight:300;color:#82aace'>9 th floor Southern Tower, Two Rivers</p>
                                    <p style='font-weight:300;color:#82aace'>PO BOX 10518-00100, Nairobi Kenya</p>
                                    <p style='font-weight:300;color:#82aace'>Tel:+254202286800</p>
                                    <p style='font-weight:300;color:#82aace'>Cell:+254709902800</p>
                                </td>


                            </tr>
                            <tr>

                                <td style='background-color:#82aace;padding:5px;width: 400px'></td>
                                <td style='background-color:#ffe390;padding:5px;width: 100px'></td>
                                <td style='background-color:#dbe2ea;padding:5px'></td>
                            </tr>
                        </tbody>
                    </table>





                </div>
                <div style='float:left'>
                <a href='dashboard.html' class='btn btn-primary'>Back</a>
                </div>
                <div style='float:right'>

                    <button class="btn btn-info" onclick="pdf()">DOWNLOAD PDF</button>
                    <!-- <button class="btn btn-success" >UPDATE</button>
                    <button class="btn btn-danger" >DELETE</button> -->
                    <a href="login/upload.html">UPLOAD</a>
                </div>
              
            
        
    
</div>
<div class='row' style='margin:30px'>
   
</div>






    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js" integrity="sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0" crossorigin="anonymous"></script>

   
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.6.0/dist/umd/popper.min.js" integrity="sha384-KsvD1yqQ1/1+IA7gi3P0tyJcT3vR+NdBTt13hSJ2lnve8agRGXTTyNaBYmCR/Nwi" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.min.js" integrity="sha384-nsg8ua9HAw1y0W1btsyWgBklPnCUAFLuTMS2G72MMONqmOymq585AcH49TLBQObG" crossorigin="anonymous"></script>
    
  </body>

  <script type="text/javascript" src='https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.22/pdfmake.min.js'></script>
  <script type="text/javascript" src='https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.min.js'></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.68/vfs_fonts.min.js"></script>
  <script  src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.68/fonts/Roboto/Roboto-Medium.ttf"></script>
  <script type="text/javascript">
    function pdf() {

          html2canvas(document.getElementById("demo"), {
          onrendered: function (canvas) {
              var data = canvas.toDataURL();
              var docDefinition = {
                
              content: [{
                image: data,
                width: 500,
              }]
              };
              pdfMake.createPdf(docDefinition).download("gatepass.pdf");
          }
          });
      }

  </script>
</html>



from django.contrib import admin
from django.urls import path
from django.conf import settings
from . import views
from rest_framework_simplejwt.views import TokenObtainPairView,TokenRefreshView
from django.conf.urls.static import static

urlpatterns = [
  path('', views.login_view, name='loginview'),
  path('login/', views.login_view, name='loginview'),
  path('formview',views.form_view, name='formview'),
  # path('login/login.html',views.login_view, name='loginview'),
  # path('login/login',views.login_view, name='loginview'),
  path('password_reset/', views.password_reset_request, name='password_reset'),
  path('upload/', views.upload, name='upload'),
  path('view_data.html', views.showdata, name='data'),
  #path('downloadPDF/', views.GeneratePDF, name='downloadPDF'),
  path('dashboard.html', views.dashboard, name='dashboard'),
  path('dashboard.html',views.dashboard,name='dashboard'),
  path('view_data.html', views.viewdata, name='viewdata'),
  path('signup.html', views.signup, name='signup'),
  path('api/token/', TokenObtainPairView.as_view()),
  path('api/token/refresh', TokenRefreshView.as_view()),
  #path('login/login/upload.html', views.upload, name='upload'),
  path('records.html', views.records, name='records'),
  path('showname',views.showname,name='showname'),
]+ static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)


def records(request):
  try:
    the_id=request.session['form_id']
  except:
    new_form=Form()
    new_form.save()
    request.session['form_id'] = new_form.id 
    the_id=new_form.id
  if the_id==request.session['form_id']:
    records=Form.objects.all()
    myFilter= OrderFilter(request.GET, queryset=records)
    records=myFilter.qs
    context={'Form':records,'myFilter':myFilter}
    return render(request, 'records.html', context)